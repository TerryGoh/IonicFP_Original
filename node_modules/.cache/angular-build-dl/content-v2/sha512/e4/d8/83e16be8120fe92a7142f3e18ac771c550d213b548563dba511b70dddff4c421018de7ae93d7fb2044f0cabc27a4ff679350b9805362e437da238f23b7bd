{"version":3,"sources":["webpack:///src/app/pages/session-assignment-chat/session-assignment-chat.page.html","webpack:///src/app/pages/session-assignment-chat/session-assignment-chat.page.scss","webpack:///src/app/pages/session-assignment-chat/session-assignment-chat.page.ts","webpack:///src/app/services/chat.service.ts"],"names":["SessionAssignmentChatPage","globalService","nativeHttp","storage","assignmentsService","activatedRoute","formBuilder","modalController","networkService","chatService","createchatForm","group","recipientname","chattext","required","currentRecipient","token","getselectedtoken","studentid","getselectedStudentId","sessionstatusended","SESSION_STATUS_ENDED","APIRetrieveChatInAssignment","CallAPIListOfRecipient","sessionstatus","getselectedsessionstatus","setTimeout","content","scrollToBottom","dismiss","selectrecipient","online","presentNetworkMsg","valid","APISendChatInAssignment","asgmid","getselectedasgmtid","setDataSerializer","post","apiUrl","then","response","data","JSON","parse","set","console","log","get","val","chatIRecived","e","error","presentError","status","setInterval","presentErrorchat","listRecipient","noofparticipant","length","selector","template","ChatService","toastCtrl","alertController","loadingController","text","create","header","duration","position","buttons","role","cssClass","toast","present","providedIn"],"mappings":"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","file":"default~pages-session-assignment-chat-session-assignment-chat-module~pages-session-assignment-view-s~7063bba7-es5.js","sourcesContent":["export default \"<ion-header *ngIf=\\\"this.sessionstatus!==this.sessionstatusended\\\" style=\\\"padding:3%;background-color:#274c9c;\\\">\\n  <ion-title style=\\\"text-align: center;color:white;display:inline-flexbox;\\\" ><b>Instant Messaging</b><img (click)=\\\"DismissModal()\\\" style=\\\"width: 1.2em;position:absolute;right:0;\\\" src=\\\"assets/images/criss-cross_grayblue.png\\\"></ion-title>\\n  </ion-header>\\n  <!--Read-->\\n  <ion-header *ngIf=\\\"this.sessionstatus===this.sessionstatusended\\\" style=\\\"padding:3%;background-color:#b2b2b2;\\\">\\n    <ion-title style=\\\"text-align: center;color:#808080;display:inline-flexbox;\\\" ><b>Instant Messaging</b><img (click)=\\\"DismissModal()\\\" style=\\\"width: 1.2em;position:absolute;right:0;\\\" src=\\\"assets/images/criss-cross_grayblue.png\\\"></ion-title>\\n    </ion-header>\\n<ion-content #content overflow-scroll=\\\"true\\\">\\n<div class=\\\"thirdcontent\\\" *ngFor=\\\"let chat of chatIRecived\\\">\\n<ion-row >\\n  <ion-col *ngIf=\\\"chat.sender_Id!=this.studentid\\\" size=\\\"9\\\"  class=\\\"message other-message\\\">\\n    <b>{{chat.sender_Username}} to {{chat.recipient_Username}}:</b><br>\\n    <span>{{chat.chat_Value}}</span>\\n    <div class=\\\"time\\\" text-right><br>\\n      <ion-label> {{chat.created_On| date:'medium'}}</ion-label>\\n    </div>\\n  </ion-col>\\n  </ion-row>\\n  <ion-row>\\n    <ion-col offset=\\\"3\\\" *ngIf=\\\"chat.sender_Id==this.studentid\\\"  size=\\\"9\\\" class=\\\"message my-message\\\">\\n      <b>{{chat.sender_Username}} to {{chat.recipient_Username}}:</b><br>\\n      <span>{{chat.chat_Value}}</span>\\n      <div class=\\\"time\\\" text-right><br>\\n        <ion-label> {{chat.created_On| date:'medium'}}</ion-label>\\n        <!-- <ion-datetime value=\\\"{{chat.created_On}}\\\" displayFormat=\\\"D MMM YYYY, H:mm\\\" display-timezone=\\\"utc\\\"></ion-datetime>    -->\\n      </div>\\n    </ion-col>\\n    </ion-row>\\n    \\n    \\n</div>\\n</ion-content>\\n<!--No Read-->\\n<ion-footer>\\n<ion-toolbar >\\n  <form [formGroup]=\\\"createchatForm\\\" *ngIf=\\\"this.sessionstatus!==this.sessionstatusended\\\">\\n<ion-row>  \\n  <ion-col size=\\\"2\\\" class=\\\"ion-align-self-center\\\">\\n  <ion-text>To:</ion-text>\\n  </ion-col>\\n      <ion-col offset=\\\"-1\\\" size=\\\"5\\\">\\n      <ion-select [(ngModel)]=\\\"recipientname\\\"  formControlName=\\\"recipientname\\\" style=\\\"background-color: #808080;color:black;\\\" #mySelect  (ionChange)=\\\"selectChanged(mySelect.value)\\\">\\n        <ion-select-option><label>Everyone</label></ion-select-option>\\n        <div *ngFor=\\\"let recipient of listRecipient\\\">\\n        <ion-select-option value=\\\"{{recipient.user_Id}}\\\" *ngIf=\\\"recipient.user_Id!=this.studentid&&this.noofparticipant!=1\\\"><label>{{ recipient.user_Username }}</label></ion-select-option>\\n      </div>\\n      </ion-select>\\n    </ion-col>\\n  <ion-col size=\\\"10\\\">\\n  <textarea formControlName=\\\"chattext\\\" autosize maxRows=\\\"4\\\"  [(ngModel)]=\\\"chattext\\\" class=\\\"message-input\\\"></textarea>\\n  </ion-col>\\n  <ion-col size=\\\"2\\\" class=\\\"ion-align-self-center\\\">\\n    <img style=\\\"width:2em;\\\" src=\\\"assets/images/user-interface.png\\\" (click)=\\\"SendMessage()\\\"><br/>\\n  </ion-col>\\n</ion-row>\\n</form>\\n</ion-toolbar>\\n</ion-footer>\\n\\n\\n\";","export default \".message {\\n  padding: 1em;\\n  border-radius: 1em;\\n  margin-bottom: 1em;\\n  white-space: pre-wrap;\\n}\\n\\n.other-message {\\n  background: #f0f0a7;\\n  color: #000000;\\n}\\n\\n.my-message {\\n  background: #d9f6ff;\\n  color: #000000;\\n}\\n\\n.time {\\n  color: #808080;\\n  float: right;\\n  font-size: small;\\n}\\n\\n.message-input {\\n  width: 100%;\\n  border: 0.1em solid var(--ion-color-medium);\\n  border-radius: 1em;\\n  resize: none;\\n  padding-left: 1em;\\n  padding-right: 1em;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvc2Vzc2lvbi1hc3NpZ25tZW50LWNoYXQvQzpcXHdvcmtpbmdcXE5ZUF9Qcm9qXFxpb25pY19wcm9qZWN0XFxGU1BfU0xQX0FQUEFJL3NyY1xcYXBwXFxwYWdlc1xcc2Vzc2lvbi1hc3NpZ25tZW50LWNoYXRcXHNlc3Npb24tYXNzaWdubWVudC1jaGF0LnBhZ2Uuc2NzcyIsInNyYy9hcHAvcGFnZXMvc2Vzc2lvbi1hc3NpZ25tZW50LWNoYXQvc2Vzc2lvbi1hc3NpZ25tZW50LWNoYXQucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsWUFBQTtFQUNBLGtCQUFBO0VBQ0Esa0JBQUE7RUFDQSxxQkFBQTtBQ0NGOztBREVBO0VBQ0MsbUJBQUE7RUFDQSxjQUFBO0FDQ0Q7O0FERUE7RUFDRSxtQkFBQTtFQUNBLGNBQUE7QUNDRjs7QURFQTtFQUNDLGNBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7QUNDRDs7QURFQTtFQUNFLFdBQUE7RUFDQSwyQ0FBQTtFQUNBLGtCQUFBO0VBQ0EsWUFBQTtFQUNBLGlCQUFBO0VBQ0Esa0JBQUE7QUNDRiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL3Nlc3Npb24tYXNzaWdubWVudC1jaGF0L3Nlc3Npb24tYXNzaWdubWVudC1jaGF0LnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5tZXNzYWdlIHtcbiAgcGFkZGluZzogMWVtO1xuICBib3JkZXItcmFkaXVzOiAxZW07XG4gIG1hcmdpbi1ib3R0b206IDFlbTtcbiAgd2hpdGUtc3BhY2U6IHByZS13cmFwO1xufVxuXG4ub3RoZXItbWVzc2FnZSB7XG4gYmFja2dyb3VuZDogI2YwZjBhNztcbiBjb2xvcjogIzAwMDAwMDtcbn1cblxuLm15LW1lc3NhZ2Uge1xuICBiYWNrZ3JvdW5kOiAjZDlmNmZmO1xuICBjb2xvcjogIzAwMDAwMDtcbn1cblxuLnRpbWUge1xuIGNvbG9yOiAjODA4MDgwO1xuIGZsb2F0OiByaWdodDtcbiBmb250LXNpemU6IHNtYWxsO1xufVxuXG4ubWVzc2FnZS1pbnB1dCB7XG4gIHdpZHRoOiAxMDAlO1xuICBib3JkZXI6IDAuMWVtIHNvbGlkIHZhcigtLWlvbi1jb2xvci1tZWRpdW0pO1xuICBib3JkZXItcmFkaXVzOiAxZW07XG4gIHJlc2l6ZTogbm9uZTtcbiAgcGFkZGluZy1sZWZ0OiAxZW07XG4gIHBhZGRpbmctcmlnaHQ6IDFlbTtcbn0iLCIubWVzc2FnZSB7XG4gIHBhZGRpbmc6IDFlbTtcbiAgYm9yZGVyLXJhZGl1czogMWVtO1xuICBtYXJnaW4tYm90dG9tOiAxZW07XG4gIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbn1cblxuLm90aGVyLW1lc3NhZ2Uge1xuICBiYWNrZ3JvdW5kOiAjZjBmMGE3O1xuICBjb2xvcjogIzAwMDAwMDtcbn1cblxuLm15LW1lc3NhZ2Uge1xuICBiYWNrZ3JvdW5kOiAjZDlmNmZmO1xuICBjb2xvcjogIzAwMDAwMDtcbn1cblxuLnRpbWUge1xuICBjb2xvcjogIzgwODA4MDtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBmb250LXNpemU6IHNtYWxsO1xufVxuXG4ubWVzc2FnZS1pbnB1dCB7XG4gIHdpZHRoOiAxMDAlO1xuICBib3JkZXI6IDAuMWVtIHNvbGlkIHZhcigtLWlvbi1jb2xvci1tZWRpdW0pO1xuICBib3JkZXItcmFkaXVzOiAxZW07XG4gIHJlc2l6ZTogbm9uZTtcbiAgcGFkZGluZy1sZWZ0OiAxZW07XG4gIHBhZGRpbmctcmlnaHQ6IDFlbTtcbn0iXX0= */\";","import { Component,ViewChild,OnInit } from '@angular/core';\nimport { ModalController } from '@ionic/angular';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\nimport {NetworkService} from '../../services/network.service';\nimport {ChatService} from '../../services/chat.service';\nimport { HTTP } from '@ionic-native/http/ngx';\nimport { AssignmentsService } from '../../services/assignments.service';\nimport {SessionStatus,apiurl} from '../../model/global-api';\nimport { Storage } from '@ionic/storage';\nimport {  GlobalService} from '../../services/global.service';\n@Component({\n  selector: 'app-session-assignment-chat',\n  templateUrl: './session-assignment-chat.page.html',\n  styleUrls: ['./session-assignment-chat.page.scss'],\n})\nexport class SessionAssignmentChatPage implements OnInit {\n  constructor(private globalService: GlobalService,private nativeHttp:HTTP,private storage:Storage,private assignmentsService: AssignmentsService,private activatedRoute: ActivatedRoute, public formBuilder: FormBuilder, private modalController:ModalController,private networkService:NetworkService,private chatService:ChatService) {\n    this.createchatForm = formBuilder.group({\n      recipientname: [''],\n      chattext: ['', Validators.required]\n  });\n  }\n  \n  @ViewChild('content') content: any;\n  public recipients: Array<string>;\n  public currentRecipient: string;\n sessionstatus:any;sessionstatusended:any;asgmid:any;chatIRecived:any;\n //Form \n public createchatForm: FormGroup;recipientname:any;chattext:any;listRecipient:any;noofparticipant:any;\n\n //User Info\n token:any;studentid:any;\n  ngOnInit(){\n    this.currentRecipient = \"Everyone\";\n    this.recipientname=\"Everyone\";\n  }\n  ionViewWillEnter(): void {\n    this.token=this.globalService.getselectedtoken() //Get Token\n    this.studentid=this.globalService.getselectedStudentId()//Get Tutor\n    this.sessionstatusended=SessionStatus.SESSION_STATUS_ENDED;\n    this.APIRetrieveChatInAssignment();//Retrive Chats\n    this.CallAPIListOfRecipient();//Receive Participant in Session\n    this.sessionstatus=this.assignmentsService.getselectedsessionstatus();//Get Session Status\n   setTimeout(() => {\n      this.content.scrollToBottom(300);\n  }, 2000);\n  \n}\n    //Close Chat\n    DismissModal(){\n      this.modalController.dismiss();\n    }\n    //Change of selected recipient\n    selectChanged(selectrecipient) {\n      this.currentRecipient = selectrecipient;\n      this.recipientname = selectrecipient;\n     // console.log(this.recipientname)\n     }\n    SendMessage(){\n      if(this.networkService.online == false )\n      {\n        this.networkService.presentNetworkMsg(); \n      }\n      else{\n      if(this.createchatForm.valid)\n      {\n        //POST METHOD\n       // console.log(this.recipientname)\n       // console.log(this.chattext)\n        this.APISendChatInAssignment() //Send Message\n         this.chattext=\"\";\n      }\n      }\n    }\n    /*POST METHOD*/\n APIRetrieveChatInAssignment()\n {\n   this.asgmid=this.assignmentsService.getselectedasgmtid()\n  this.nativeHttp.setDataSerializer('json');\n   this.nativeHttp.post(apiurl.apiUrl+'chat/retrieve', {\n    \"Authentication_Token\":this.token, //Get from storage \n   \"Asgmt_Id\":this.asgmid,\n   \"User_Id\": this.studentid,//Get from storage \n}, {\n  'Accept': 'application/json',\n  'Content-Type': 'application/json' })\n  .then(response => {\n    try {\n      response.data = JSON.parse(response.data);\n      this.storage.set('chatdetails', response.data); \n      console.log(response.data)\n      this.storage.get('chatdetails').then((val) => {\n        this.chatIRecived=val;\n        });\n    } catch(e) {\n      console.error(e);\n      this.modalController.dismiss();\n      this.assignmentsService.presentError()\n    }\n })\n .catch(response => {\n   // prints 403\n  console.log(response.status);\n\n   // prints Permission denied\n  console.log(response.error);\n  this.modalController.dismiss();\n  this.assignmentsService.presentError()\n\n });\n }\n   /*POST METHOD*/\n   APISendChatInAssignment()\n   {\n     this.asgmid=this.assignmentsService.getselectedasgmtid()//Get Assignment Id\n    this.nativeHttp.setDataSerializer('json');\n     this.nativeHttp.post(apiurl.apiUrl+'chat/send', {\n    \"Authentication_Token\":this.token, //Get from storage \n     \"Asgmt_Id\":this.asgmid,\n     \"Sender\":this.studentid,\n     \"Recipient\":this.recipientname,\n     \"Chat_Value\":this.chattext\n  }, {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json' })\n    .then(response => {\n      try {\n       response.data = JSON.parse(response.data);\n       // this.APIRetrieveChatInAssignment();\n        setInterval(() => { \n          this.APIRetrieveChatInAssignment(); // Now the \"this\" still references the component\n       }, 500);//half a second\n       this.content.scrollToBottom();\n     \n      } catch(e) {\n        console.error(e);\n        this.assignmentsService.presentErrorchat()\n      }\n   })\n   .catch(response => {\n     // prints 403\n    console.log(response.status);\n  \n     // prints Permission denied\n    console.log(response.error);\n    this.assignmentsService.presentErrorchat()\n   });\n   }\n  /*Call APIListRecipient METHOD*/\n   CallAPIListOfRecipient(){\n    this.asgmid=this.assignmentsService.getselectedasgmtid() //Get asgmt id\n    this.nativeHttp.setDataSerializer('json');\n    this.nativeHttp.post(apiurl.apiUrl+'chat/listRecipient', {\n   \"Authentication_Token\":this.token, //Get from storage \n    \"Asgmt_Id\":this.asgmid,\n    \"User_Id\": this.studentid,\n }, {\n   'Accept': 'application/json',\n   'Content-Type': 'application/json' })\n   .then(response => {\n     try {\n       response.data = JSON.parse(response.data);\n       //console.log(response.data)\n       this.listRecipient=response.data;\n       this.noofparticipant=this.listRecipient.length;\n     } catch(e) {\n       console.error(e);\n       this.modalController.dismiss();\n       this.assignmentsService.presentError()\n     }\n  })\n  .catch(response => {\n    // prints 403\n   console.log(response.status);\n \n    // prints Permission denied\n   console.log(response.error);\n   this.modalController.dismiss();\n   this.assignmentsService.presentError() \n   });\n   }\n}\n","import { Injectable } from '@angular/core';\nimport {ToastController,AlertController,LoadingController } from '@ionic/angular';\nimport { HTTP } from '@ionic-native/http/ngx';\nimport { Storage } from '@ionic/storage';\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChatService {\n\nconstructor(private nativeHttp:HTTP,private toastCtrl: ToastController,private alertController:AlertController,public loadingController: LoadingController,private storage:Storage) {}\n\n public data:any;\n  //Pop-up message\nasync presentToastWithOptions(text) {\n  const toast = await this.toastCtrl.create({\n    header: text,\n    duration: 3000,\n    position: 'bottom',\n    buttons: [{\n      text: 'CLOSE',\n      role: 'cancel'\n    }],\n    cssClass: 'toastCSS'\n  });\n  toast.present();\n}\n\n\n}\n"]}